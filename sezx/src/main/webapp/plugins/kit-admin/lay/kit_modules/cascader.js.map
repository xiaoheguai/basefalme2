{"version":3,"sources":["cascader.js"],"names":["layui","define","exports","MOD_NAME","$","jquery","layer","utils","_","lodash","laytpl","tpl","_private","renderHTML","data","filter","opts","temps","callback","pid","placeholder","_elem","length","join","render","that","content","isFunction","recursion","temp","datas","this","forEach","item","index","curr","push","value","label","children","id","Cascader","_classCallCheck","config","randomCode","_createClass","key","extend","options","elem","undefined","defaultValues","disabled","onChange","onClick","isObject","warn","isString","console","_input","find","e","stope","_cascaderBox","hasClass","addClass","document","one","e1","removeClass","_item","siblings","selectedData","_child","hasChildren","i","attr","labels","obj","events"],"mappings":"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","file":"cascader.js","sourcesContent":["/**\n  扩展一个cascader模块\n**/\n\nlayui.define(['layer', 'utils', 'axios', 'laytpl'], function(exports) { //提示：模块也可以依赖其它模块，如：layui.define('layer', callback);\n  const MOD_NAME = 'cascader',\n    $ = layui.jquery,\n    layer = layui.layer,\n    utils = layui.utils,\n    _ = layui.lodash,\n    laytpl = layui.laytpl;\n\n  const _private = {\n    tpl: [\n      '<div class=\"kit-cascader\" kit-filter=\"{{d.filter}}\">',\n      '  <div class=\"kit-cascader-title\">',\n      '    <span class=\"kit-cascader-show\">{{d.placeholder}}</span>',\n      '    <div class=\"kit-icon\">',\n      '      <i class=\"layui-icon\">&#xe61a;</i>',\n      '    </div>',\n      '  </div>',\n      '  {{d.content}}',\n      '</div>'\n    ],\n    // 渲染HTML\n    renderHTML: function(opts) {\n      var that = this;\n      const { _elem, data, callback, filter } = opts;\n\n      var temps = ['<ul class=\"kit-cascader-list\">'];\n      var pid = 0; //一级菜单pid为0 ，这是一个约定\n      that.recursion(temps, data, pid);\n      // 读取input属性\n      const { placeholder } = _elem[0];\n      _elem.attr('lay-filter', filter);\n      if (temps.length > 0) {\n        // 闭合ul\n        temps.push('</ul>');\n        // 渲染页面\n        laytpl(that.tpl.join('')).render({\n          placeholder: placeholder === '' ? 'Please select' : placeholder,\n          content: temps.join(''),\n          filter\n        }, function(html) {\n          _elem.after(html);\n          utils.isFunction(callback) && callback();\n        });\n      }\n    },\n    // 递归组装dom\n    recursion: function(temp, datas, pid) {\n      var that = this;\n      var curr = [];\n      _.forEach(datas, function(item, index) {\n        if (item.pid === pid)\n          curr.push(item);\n      });\n      if (curr.length > 0) {\n        _.forEach(curr, function(item) {\n          temp.push('<li class=\"kit-item\" data-value=\"' + item.value + '\" data-label=\"' + item.label + '\">');\n          temp.push('<a href=\"javascript:;\">');\n          temp.push('<span>' + item.label + '</span>');\n          var children = item.children;\n          if (children !== undefined && children !== null && children.length > 0) {\n            temp.push('<i class=\"layui-icon\">&#xe602;</i>');\n          }\n          temp.push('</a>');\n          if (children !== undefined && children !== null && children.length > 0) {\n            temp.push('<ul class=\"kit-cascader-child layui-anim layui-anim-fadein\">');\n            that.recursion(temp, children, item.id);\n            temp.push('</ul>');\n          }\n          temp.push('</li>');\n        });\n      }\n    },\n  };\n\n  class Cascader {\n    constructor() {\n      this.config = {\n        filter: utils.randomCode()\n      };\n    }\n    set(options) {\n      $.extend(true, this.config, options);\n      return this;\n    }\n    render(opts) {\n      const that = this;\n      const config = that.config;\n      const options = {\n        elem: undefined,\n        defaultValues: [],\n        disabled: false,\n        data: [],\n        onChange: undefined,\n        onClick: undefined,\n        filter: config.filter\n      };\n      $.extend(true, options, opts);\n      if (options.elem === undefined) {\n        console.warn('Cascader Error:请为cascader绑定elem.');\n        return;\n      } else if (utils.isString(options.elem) && $(options.elem).length === 0) {\n        console.warn('Cascader Error:请为cascader绑定elem.');\n        return;\n      } else if (utils.isObject(options.elem) && options.elem.length === 0) {\n        console.warn('Cascader Error:请为cascader绑定elem.');\n        return;\n      } else {\n        options.elem = utils.isString(options.elem) ? $(options.elem) : options.elem;\n      }\n      if (options.elem.length > 1) {\n        console.warn('Cascader Error:一次只能渲染一个Cascader.');\n        return;\n      }\n      _private.renderHTML({\n        filter: options.filter,\n        _elem: options.elem,\n        data: [{\n          id: 1,\n          pid: 0,\n          value: '440000',\n          label: '广东省',\n          children: [{\n            id: 2,\n            pid: 1,\n            value: '440100',\n            label: '广州市',\n            children: [{\n              id: 3,\n              pid: 2,\n              value: '440106',\n              label: '天河区'\n            }, {\n              id: 4,\n              pid: 2,\n              value: '440104',\n              label: '越秀区'\n            }, {\n              id: 5,\n              pid: 2,\n              value: '440105',\n              label: '海珠区'\n            }]\n          }]\n        }, {\n          id: 11,\n          pid: 0,\n          value: '510000',\n          label: '四川省',\n          children: [{\n            id: 22,\n            pid: 11,\n            value: '510100',\n            label: '成都市',\n            children: [{\n              id: 33,\n              pid: 22,\n              value: '510101',\n              label: '市辖区'\n            }, {\n              id: 44,\n              pid: 22,\n              value: '510104',\n              label: '锦江区'\n            }, {\n              id: 55,\n              pid: 22,\n              value: '510105',\n              label: '青羊区'\n            }]\n          }]\n        }],\n        callback: function() {\n          that.bind(options);\n        }\n      });\n    }\n    bind(options) {\n      var _elem = $('*[kit-filter=' + options.filter + ']');\n      var _input = _elem.find('.kit-cascader-show');\n      var _cascaderBox = undefined;\n      _input.on('click', function(e) {\n        layui.stope(e);\n        _cascaderBox = _elem.find('.kit-cascader-list');\n        if (!_cascaderBox.hasClass('layui-show')) {\n          _cascaderBox.addClass('layui-show');\n          $(document).one('click', function(e1) {\n            layui.stope(e1);\n            _cascaderBox.removeClass('layui-show');\n          });\n        }\n      });\n      // 处理选项点击事件\n      _elem.find('.kit-item').on('click', function(e) {\n        layui.stope(e);\n        let selectedData = {\n          values: [],\n          labels: [],\n          objs: []\n        };\n        // 获取当前点击的DOM\n        const _item = $(this);\n        // 选中当前DOM 移除其他DOM样式\n        _item.addClass('layui-this').siblings().removeClass('layui-this');\n        // 获取该节点下的子节点\n        const _child = _item.children('.kit-cascader-child');\n        // 是否存在子节点\n        const hasChildren = _child.length > 0;\n        if (hasChildren) {\n          // 移除其他兄弟节点的选中状态\n          _item.siblings().find('.kit-item').removeClass('layui-this');\n          // 移除其他兄弟节点的显示状态\n          _item.siblings().find('.kit-cascader-child').removeClass('layui-show');\n          // 显示当前子节点\n          _child.addClass('layui-show');\n        } else {\n          // 读取选择的数据\n          _elem.find('li.layui-this').each(function(i, e) {\n            const value = $(this).attr('data-value');\n            const label = $(this).attr('data-label');\n            selectedData.values.push(value);\n            selectedData.labels.push(label);\n            selectedData.objs.push({\n              value,\n              label\n            });\n          });\n          // 隐藏\n          _cascaderBox && _cascaderBox.removeClass('layui-show');\n          // 赋值\n          _input.html(selectedData.labels.join('/'));\n          options.elem.val(selectedData.values.join(','));\n          //执行事件\n          utils.isFunction(options.onChange) && options.onChange({\n            elem: options.elem,\n            obj: selectedData\n          });\n        }\n        //执行事件\n        utils.isFunction(options.onClick) && options.onClick({\n          elem: _item,\n          obj: {\n            value: _item.attr('data-value'),\n            label: _item.attr('data-label')\n          }\n        });\n      });\n    }\n    hello() {\n      layer.msg('cccc');\n    }\n    on(events, callback) {\n      return layui.onevent.call(this, MOD_NAME, events, callback);\n    }\n  }\n\n  // var cascader = new Cascader();\n\n  //输出test接口\n  exports(MOD_NAME, Cascader);\n});"]}