{"version":3,"sources":["tabs.js"],"names":["layui","define","exports","layer","jquery","laytpl","utils","_","storage","route","lodash","KITADMINTABS","TABS","TAB_TITLE","TOOLSBOX","TAB_CLOSE","tabsContent","undefined","tabsTitle","toolsBox","templates","TITLE","CONTENT","TOOLSITEM","Tabs","onChangeBefore","onChanged","onRendered","join","isInit","prototype","that","extend","children","$","_that","close","config","options","render","callback","this","target","attr","stope","parent","remove","layid","each","index","element","_private","prevHandler","on","nextHandler","toolBoxHandler","length","e","initCaches","find","off","parents","items","item","isFunction","tabCount","exists","switch","getCurrId","getByPath","path","active","getCaches","d","id","t","append","thtml","push","html","title","component","chtml","rendered","icon","_title","findTitle","hasClass","prevLayid","rIndex","prev","liWidth","tabWidth","ol","findIndex","p","c","setCaches","arguments","handle","click","offsetLeft","width","forEach","currActive","renderHTMLForContent","_content","getContent","isRendered","findContent","addClass","elem","siblings","findTools","existsByPath","findTitleByPath","refresh","_container","init","left","parseInt","tabsLeft","substr","style","tabsWidth","indexOf","liCountWidth","colCount","PREV","toolHandler","TOOLS","document","action","data","NEXT","i","tabs","hide","currId","_c","add","getItem","setItem"],"mappings":"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","file":"tabs.js","sourcesContent":["layui.define(['layer', 'laytpl', 'utils', 'lodash', 'route'], function(exports) {\n  var layer = layui.layer,\n    $ = layui.jquery,\n    laytpl = layui.laytpl,\n    utils = layui.utils,\n    _ = layui.lodash,\n    storage = utils.localStorage,\n    route = layui.route;\n\n\n  const KITADMINTABS = 'KITADMINTABS';\n\n  var TABS = '.kit-tabs',\n    PREV = '.kit-tabs-prev',\n    NEXT = '.kit-tabs-next',\n    TOOLS = '.kit-tabs-tools',\n    TAB_TITLE = '.kit-tab-title',\n    TAB_CLOSE = '.kit-tab-close',\n    TOOLSBOX = '.kit-tabs-toolsbox';\n\n  var tabsContent = undefined,\n    tabsTitle = undefined,\n    toolsBox = undefined,\n    templates = {\n      TITLE: ['<li lay-id=\"{{d.id}}\" data-path={{d.path}}>',\n        '<span title=\"{{d.title}}\">',\n        '{{#if(d.icon){}}',\n        '<i class=\"layui-icon\">{{d.icon}}</i> ',\n        '{{#}}}',\n        '{{d.title}}',\n        '</span>',\n        '<i class=\"layui-icon kit-tab-close\">&#x1006;</i>',\n        '</li>'\n      ].join(''),\n      CONTENT: ['<div class=\"kit-tabs-item\" data-path={{d.path}} lay-tab-id=\"{{d.id}}\" data-component=\"{{d.component}}\" data-rendered=\"{{d.rendered}}\">',\n        '<router-view></router-view>',\n        '</div>'\n      ].join(''),\n      TOOLSITEM: [\n        '<li class=\"kit-item\" lay-id=\"{{d.id}}\">',\n        '<a href=\"javascript:;\">',\n        '<span title=\"{{d.title}}\">{{d.title}}</span>&nbsp;',\n        '<i class=\"layui-icon layui-close\">&#x1006;</i>',\n        '</a>',\n        '</li>'\n      ].join('')\n    };\n\n  var Tabs = function() {\n    this.config = {\n      onChangeBefore: undefined,\n      onChanged: undefined,\n      onRendered: undefined\n    };\n    this.version = '1.0.0';\n  }\n  var isInit = false;\n  Tabs.prototype.set = function(options) {\n    var that = this;\n    $.extend(true, that.config, options);\n    return that;\n  };\n  Tabs.prototype.render = function(callback) {\n    var that = this;\n    var target = $(TABS).attr('kit-target');\n    tabsTitle = tabsTitle === undefined ? $(TAB_TITLE) : tabsTitle;\n    tabsContent = tabsContent === undefined ? $('div.kit-tabs-content[kit-tabs=\"' + target + '\"]') : tabsContent;\n    toolsBox = toolsBox === undefined ? $(TOOLSBOX).children('ul') : toolsBox;\n\n    tabsTitle.children('li').each(function(index, element) {\n      var _that = $(this);\n      var layid = _that.attr('lay-id');\n      _that.off('click').on('click', function() {\n        that.switch(layid);\n      });\n      var close = _that.find(TAB_CLOSE);\n      if (close.length === 1) {\n        close.off('click').on('click', function(e) {\n          layui.stope(e);\n          that.remove(layid);\n        });\n      }\n      // 绑定工具栏的移除事件\n      $(TOOLSBOX).find('.layui-close').off('click').on('click', function(e) {\n        layui.stope(e);\n        var parent = $(this).parents('.kit-item')\n        var layid = parent.attr('lay-id');\n        that.remove(layid);\n      });\n    });\n    _private.prevHandler();\n    _private.nextHandler();\n    _private.toolHandler();\n    _private.toolBoxHandler(that);\n    if (!isInit) {\n      isInit = true;\n      _private.initCaches(that);\n    }\n    utils.isFunction(callback) && callback({\n      tabCount: $(TAB_TITLE).children('li').length,\n      isIndex: _private.findTitle(_private.getCurrId()).attr('data-path') === '#/'\n    });\n    return that;\n  };\n  Tabs.prototype.add = function(options, callback) {\n    var that = this,\n      config = that.config;\n    if (options.active === undefined) {\n      // 读取缓存的tabs\n      var items = _private.getCaches();\n      var item = utils.find(items, function(d) {\n        return d.path === options.path;\n      });\n      // 如果在缓存中找到对应的tab信息则覆盖id\n      if (item !== undefined) {\n        options.id = item.id;\n      }\n      if (that.exists(options.id)) {\n        that.switch(options.id);\n        return;\n      } else if (that.existsByPath(options.path)) { //如果通过layid找不到则通过路由地址找\n        var t = that.getByPath(options.path);\n        that.switch(t.id);\n        return;\n      }\n    } else {\n      // 处理读取历史初始化的tabs\n      if (that.exists(options.id)) {\n        that.switch(options.id, true);\n        return;\n      } else if (that.existsByPath(options.path)) { //如果通过layid找不到则通过路由地址找\n        var t = that.getByPath(options.path);\n        that.switch(t.id, true);\n        return;\n      }\n    }\n    laytpl(templates.TITLE).render(options, function(html) {\n      // 渲染title\n      tabsTitle.append(html);\n      // 渲染主体内容\n      laytpl(templates.CONTENT).render(options, function(chtml) {\n        tabsContent.append(chtml);\n        //添加至右侧工具栏\n        laytpl(templates.TOOLSITEM).render(options, function(thtml) {\n          toolsBox.append(thtml);\n          // 处理缓存\n          var items = _private.getCaches();\n          var item = utils.find(items, function(d) {\n            return d.path === options.path;\n          });\n          // 如果不存在，则添加一个\n          if (item === undefined) {\n            items.push({\n              id: options.id,\n              title: options.title,\n              path: options.path,\n              component: options.component,\n              rendered: false,\n              active: true,\n              icon: options.icon\n            });\n          } else {\n            // 更新id\n            item.id = options.id;\n          }\n          _private.setCaches(items); //保存缓存数据\n          // 重新渲染\n          that.render();\n          if (options.active === undefined) {\n            that.switch(options.id); //获取焦点\n          } else {\n            if (options.active) that.switch(options.id, true);\n          }\n          utils.isFunction(callback) && callback();\n        });\n      });\n      // utils.isFunction(config.onRendered) && config.onRendered();\n    });\n  };\n  Tabs.prototype.remove = function(layid) {\n    var that = this;\n    var _title = _private.findTitle(layid);\n    // 如果是删除当前获取焦点的选项卡才销换到上一个，否则不切换\n    if (_title.hasClass('layui-this')) {\n      var prevLayid = _title.prev().attr('lay-id');\n      // 切换到上一个选项卡\n      that.switch(prevLayid);\n    }\n    // 移除\n    _title.remove();\n    _private.findContent(layid).remove();\n    _private.findTools(layid).remove();\n\n    var items = _private.getCaches();\n    var rIndex = items.findIndex(p => p.id === layid);\n    items.splice(rIndex, 1);\n    _private.setCaches(items);\n  };\n  Tabs.prototype.switch = function(layid, isInit = false) {\n    var that = this,\n      config = that.config;\n    var _that = _private.findTitle(layid);\n    if (_that.length === 0)\n      return;\n    var liWidth = _that.width() + 50;\n    var ol = _that[0].offsetLeft;\n    var tabWidth = tabsTitle.parent('div.kit-tab').width();\n    if (ol > tabWidth) {\n      var c = ol - tabWidth + liWidth;\n    }\n    var path = _that.attr('data-path');\n    var items = _private.getCaches();\n    var item = utils.find(items, function(d) {\n      return d.path === path;\n    });\n    // 如果是初始化，只切换到上一次选中的选项卡\n    if (item !== undefined && item.active && isInit) {\n      handle();\n      _that.click(); // 模拟点击当前选中的选项卡\n    }\n    // 如果是点击切换\n    if (!isInit) {\n      handle();\n      _.forEach(items, function(item) {\n        item.active = false;\n      });\n      var currActive = utils.find(items, function(d) {\n        return d.path === path;\n      });\n      if (currActive !== undefined) {\n        currActive.active = true;\n      }\n      _private.setCaches(items);\n      var _content = _private.getContent(layid);\n      // 如果该选项卡未渲染则需要执行渲染操作\n      if (!_content.isRendered) {\n        _private.renderHTMLForContent(_content.elem, _content.path);\n      }\n    }\n\n    // 触发选项卡切换事件\n    utils.isFunction(config.onChanged) && config.onChanged(layid);\n    /** \n     * 处理样式切换\n     */\n    function handle() {\n      // 切换对应的title item\n      _that.addClass('layui-this')\n        .siblings().removeClass('layui-this');\n      // 切换对应的content item\n      _private.findContent(layid)\n        .addClass('layui-show')\n        .siblings().removeClass('layui-show');\n      // 切换对应的tools item\n      _private.findTools(layid)\n        .addClass('layui-this')\n        .siblings().removeClass('layui-this');\n\n      var _content = _private.getContent(layid);\n      // 设置浏览器地址显示\n      utils.setUrlState(_content.path, _content.path);\n    }\n  }\n  Tabs.prototype.switchByPath = function(path) {\n    var that = this;\n    var _title = _private.findTitleByPath(path);\n    if (_title.length > 0) {\n      that.switch(_title.attr('lay-id'));\n    }\n  }\n  Tabs.prototype.exists = function(layid) {\n    return _private.findTitle(layid).length > 0;\n  }\n  Tabs.prototype.existsByPath = function(path) {\n    return _private.findTitleByPath(path).length > 0;\n  }\n  Tabs.prototype.get = function(layid) {\n    var that = this;\n    if (!that.exists(layid))\n      return null;\n    var _title = _private.findTitle(layid);\n    var title = _title.children('span').text();\n    var path = _title.attr('data-path');\n    var _content = _private.getContent(layid);\n    return {\n      id: layid,\n      title: title,\n      path: path,\n      _content: _content\n    };\n  }\n  Tabs.prototype.getByPath = function(path) {\n    var that = this;\n    if (!that.existsByPath(path))\n      return null;\n    var _title = _private.findTitleByPath(path);\n    var title = _title.children('span').text();\n    var layid = _title.attr('lay-id');\n    return {\n      id: layid,\n      title: title,\n      path: path\n    };\n  }\n  Tabs.prototype.getCurrId = function() {\n    return _private.getCurrId();\n  };\n  Tabs.prototype.init = function() {\n    var that = this;\n    _private.initCaches(that);\n    return that;\n  };\n  /**\n   * 刷新指定的选项卡，如果参数为空则刷新当前的选项卡\n   * @param {*} layid \n   */\n  Tabs.prototype.refresh = function(layid) {\n    layid = layid || _private.getCurrId();\n    var _content = _private.getContent(layid);\n    _private.renderHTMLForContent(_content.elem, _content.path);\n  };\n\n  var _private = {\n    renderHTMLForContent(_container, path) {\n      route.render(path, _container, function() {\n        // 将状态更新为已渲染\n        _container.attr('data-rendered', 'true');\n      });\n    },\n    prevHandler: function() {\n      // prev event\n      $(PREV).off('click').on('click', function() {\n        var tabsLeft = tabsTitle[0].style.left;\n        var left = parseInt(tabsLeft.substr(0, tabsLeft.indexOf('px')));\n\n        if (left === 0) {\n          return;\n        } else {\n          left += $(TABS).width();\n          left = left > 0 ? 0 : left;\n          tabsTitle.animate({\n            'left': left + 'px'\n          });\n        }\n      });\n    },\n    nextHandler: function() {\n      // next event\n      $(NEXT).off('click').on('click', function() {\n        var tabsLeft = tabsTitle[0].style.left;\n        var left = parseInt(tabsLeft.substr(0, tabsLeft.indexOf('px')));\n\n        var tabsWidth = $(TABS).width();\n        var liCountWidth = -18;\n        tabsTitle.children('li').each(function() {\n          var width = $(this).width();\n          liCountWidth += (width + 48);\n        });\n        if (tabsWidth < liCountWidth && (left - tabsWidth) > -liCountWidth) {\n          var colCount = parseInt(liCountWidth / tabsWidth);\n          left = (left - tabsWidth) >= 0 ? 0 : (left - tabsWidth);\n\n          tabsTitle.animate({\n            'left': left + 'px'\n          });\n        }\n      });\n    },\n    toolHandler: function() {\n      $(TOOLS).off('click').on('click', function(e) {\n        layui.stope(e);\n        $(TOOLSBOX).show();\n        $(document).on('click', function() {\n          $(TOOLSBOX).hide();\n          $(this).off('click');\n        });\n      });\n    },\n    toolBoxHandler: function(tabs) {\n      var that = this;\n      $(TOOLSBOX).find('li.kit-item').each(function() {\n        var _that = $(this);\n        var action = _that.data('action');\n        var currId = _that.attr('lay-id');\n        _that.off('click').on('click', function() {\n          var layid = that.getCurrId();\n          switch (action) {\n            case 'closeOther':\n              tabsTitle.find('li:not(\"[lay-id=' + layid + ']\")').each(function(i, e) {\n                var id = $(this).attr('lay-id');\n                if (i !== 0) {\n                  tabs.remove(id);\n                }\n              });\n              break;\n            case 'closeAll':\n              tabsTitle.find('li:first-child').siblings().each(function() {\n                var id = $(this).attr('lay-id');\n                tabs.remove(id);\n              });\n              break;\n            case 'refresh':\n              var _c = _private.getContent(layid);\n              _private.renderHTMLForContent(_c.elem, _c.path);\n              break;\n            default:\n              var _content = _private.getContent(currId);\n              if (!_content.isRendered) {\n                _private.renderHTMLForContent(_content.elem, _content.path);\n              }\n              tabs.switch(currId);\n              break;\n          }\n          $(TOOLSBOX).hide();\n        });\n      });\n    },\n    initCaches: function(_that) {\n      var items = this.getCaches();\n      _.forEach(items, function(item) {\n        _that.add(item);\n      });\n    },\n    findTitle: function(layid) {\n      return tabsTitle.children('li[lay-id=\"' + layid + '\"]');\n    },\n    findTitleByPath: function(path) {\n      return tabsTitle.children('li[data-path=\"' + path + '\"]');\n    },\n    findContent: function(layid) {\n      return tabsContent.children('div.kit-tabs-item[lay-tab-id=\"' + layid + '\"]');\n    },\n    getContent: function(layid) {\n      var _content = this.findContent(layid);\n      return {\n        elem: _content,\n        component: _content.attr('data-component'),\n        path: _content.attr('data-path'),\n        isRendered: _content.attr('data-rendered') === 'true',\n      };\n    },\n    findTools: function(layid) {\n      return toolsBox.find('li.kit-item[lay-id=\"' + layid + '\"]');\n    },\n    getCurrId: function() {\n      return tabsTitle.find('li.layui-this').attr('lay-id');\n    },\n    getCaches: function() {\n      var items = storage.getItem(KITADMINTABS);\n      if (items === null) {\n        items = [];\n      }\n      return items;\n    },\n    setCaches: function(data) {\n      storage.setItem(KITADMINTABS, data)\n    }\n  }\n\n  var tabs = new Tabs();\n\n  //输出tabs接口\n  exports('tabs', tabs);\n});"]}