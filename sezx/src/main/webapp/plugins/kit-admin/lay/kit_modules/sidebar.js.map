{"version":3,"sources":["sidebar.js"],"names":["layui","define","exports","$","jquery","laytpl","layer","_","lodash","utils","this","Sidebar","elem","content","shade","shadeClose","title","direction","dynamicRender","url","width","done","join","defaults","that","id","config","undefined","options","tplLoader","_private","renderHTML","data","extend","errMsg","oneOf","error","_elem","render","Date","getTime","html","_body","_shade","toggle","_sidebar","tpl","show","append","click","attr","on","animate","_defineProperty","find","_that","parent","_typeof","showLoading","hideLoading","setTimeout","next","addClass","_load","remove","sidebar","load_tpl"],"mappings":"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","file":"sidebar.js","sourcesContent":["layui.define(['layer', 'laytpl', 'utils', 'lodash'], function (exports) {\n  const $ = layui.jquery,\n    layer = layui.layer,\n    laytpl = layui.laytpl,\n    _ = layui.lodash,\n    utils = layui.utils,\n    _body = $('body');\n  const Sidebar = function () {\n    this.version = '1.0.0';\n  };\n  const tpl = [\n    '<div class=\"kit-sidebar\" style=\"{{d.direction}}:-{{d.width}};width:{{d.width}};\" kit-sidebar=\"{{d.id}}\">',\n    '<div class=\"kit-sidebar-body\">',\n    '  <div class=\"layui-card\">',\n    '    <div class=\"layui-card-header\">',\n    '      <span class=\"nowrap\" title=\"{{d.title}}\">{{d.title}}</span>',\n    '      <div class=\"kit-sidebar-reload\" title=\"刷新\">',\n    '        <i class=\"layui-icon\">&#xe669;</i>',\n    '      </div>',\n    '      <div class=\"kit-sidebar-close\" title=\"关闭\">',\n    '        <i class=\"layui-icon\">&#x1006;</i>',\n    '      </div>',\n    '    </div>',\n    '    <div class=\"layui-card-body\">',\n    '      {{d.content}}',\n    '    </div>',\n    '  </div>',\n    '</div>',\n    '</div>'\n  ].join('');\n  const load_tpl = [\n    '<div class=\"kit-sidebar-loading layui-anim layui-anim-fadein\">',\n    '    <div>',\n    '        <i class=\"layui-icon layui-anim layui-anim-rotate layui-anim-loop\">&#xe63e;</i>',\n    '    </div>',\n    '</div>',\n  ]\n  Sidebar.prototype.defaults = {\n    elem: undefined, // 触发按钮\n    content: '', // 内容\n    shade: false, //显示遮盖层\n    shadeClose: true, // 点击遮盖层关闭\n    title: '未命名', //标题\n    direction: 'right', //方向  支持left or right \n    dynamicRender: false, //是否动态渲染\n    url: undefined, //远程地址\n    width: '280px', //盒子的宽度\n    done: undefined\n  };\n  Sidebar.prototype.render = function (options) {\n    const that = this;\n    // 克隆默认配置 -- 为了默认配置的干净\n    let defaults = _.cloneDeep(that.defaults);\n    $.extend(true, defaults, options);\n    const config = defaults;\n    // validate\n    if (!utils.oneOf(config.direction, ['left', 'right'])) {\n      utils.error('Sidebar error: [direction] property error,Only \"left\" or \"right\" .');\n      return that;\n    }\n    const data = {\n      title: config.title,\n      id: utils.randomCode(),\n      content: config.content,\n      direction: config.direction,\n      width: config.width\n    };\n    if (config.dynamicRender) {\n      const url = config.url + '?version=' + new Date().getTime();\n      utils.tplLoader(url, function (content) {\n        data.content = content;\n        _private.renderHTML(config, data);\n      }, function (errMsg) {\n        data.content = errMsg;\n        _private.renderHTML(config, data);\n      })\n    } else {\n      _private.renderHTML(config, data);\n    }\n    return that;\n  };\n  const _private = {\n    renderHTML: function (config, data) {\n      const _elem = $(config.elem);\n      if (_elem.attr('kit-sidebar-target') !== undefined) {\n        return;\n      }\n      laytpl(tpl).render(data, function (html) {\n        // 添加遮盖层\n        if (config.shade) {\n          html = html + '<div class=\"kit-shade\" kit-shade=\"' + data.id + '\"></div>';\n        }\n        _body.append(html);\n        typeof config.done === 'function' && config.done();\n        // 处理事件\n        const _sidebar = $('div[kit-sidebar=\"' + data.id + '\"]');\n        const _shade = $('div[kit-shade=\"' + data.id + '\"]');\n        _elem.attr('data-toggle', 'off');\n        _elem.attr('kit-sidebar-target', 'true');\n        _elem.on('click', function () {\n          const toggle = $(this).data('toggle');\n          switch (toggle) {\n            case 'on':\n              _sidebar.animate({\n                [config.direction]: '-' + config.width\n              });\n              _shade.hide();\n              $(this).data('toggle', 'off');\n              break;\n            case 'off':\n              _sidebar.animate({\n                [config.direction]: '0px'\n              });\n              _shade.show();\n              $(this).data('toggle', 'on');\n              break;\n          }\n        });\n        // 如果是elem为object 则直接触发事件\n        if (typeof config.elem === 'object') {\n          _elem.click();\n        }\n        // 遮盖层点击关闭\n        config.shadeClose && _shade.on('click', function () {\n          _elem.click();\n        });\n        // 绑定刷新事件\n        _sidebar.find('.kit-sidebar-reload').on('click', function () {\n          const _that = this;\n          if (config.dynamicRender) {\n            // 显示加载层\n            _private.showLoading(_sidebar);\n            const url = config.url + '?version=' + new Date().getTime();\n            utils.tplLoader(url, function (data) {\n              $(_that).parent().next('.layui-card-body').html(data);\n              // 关闭加载层\n              _private.hideLoading(_sidebar);\n            }, function (errMsg) {\n              $(_that).parent().next('.layui-card-body').html('Loading error:' + errMsg);\n              // 关闭加载层\n              _private.hideLoading(_sidebar);\n            })\n          }\n        });\n        // 绑定关闭事件\n        _sidebar.find('.kit-sidebar-close').on('click', function () {\n          _elem.click();\n        });\n      });\n    },\n    // 显示加载层\n    showLoading: function (_sidebar) { //fadein\n      _sidebar.append(load_tpl.join(''));\n    },\n    // 移除加载层\n    hideLoading: function (_sidebar) {\n      setTimeout(function () {\n        const _load = _sidebar.find('.kit-sidebar-loading');\n        _load.addClass('layui-anim-fadeout');\n        setTimeout(function () {\n          _load.remove();\n        }, 300);\n      }, 500);\n    }\n  };\n  const sidebar = new Sidebar();\n  //输出sidebar接口\n  exports('sidebar', sidebar);\n});"]}